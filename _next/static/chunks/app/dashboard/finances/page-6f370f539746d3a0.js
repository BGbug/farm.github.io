(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8977],{4392:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var a=r(95155),n=r(12115),l=r(66695),s=r(81499),i=r(3401),c=r(94754),o=r(96025),d=r(16238),u=r(83394),h=r(46081),m=r(63540),x="Progress",[p,f]=(0,h.A)(x),[g,v]=p(x),j=n.forwardRef((e,t)=>{var r,n,l,s;let{__scopeProgress:i,value:c=null,max:o,getValueLabel:d=N,...u}=e;(o||0===o)&&!C(o)&&console.error((r="".concat(o),n="Progress","Invalid prop `max` of value `".concat(r,"` supplied to `").concat(n,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let h=C(o)?o:100;null===c||_(c,h)||console.error((l="".concat(c),s="Progress","Invalid prop `value` of value `".concat(l,"` supplied to `").concat(s,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let x=_(c,h)?c:null,p=k(x)?d(x,h):void 0;return(0,a.jsx)(g,{scope:i,value:x,max:h,children:(0,a.jsx)(m.sG.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":k(x)?x:void 0,"aria-valuetext":p,role:"progressbar","data-state":w(x,h),"data-value":null!=x?x:void 0,"data-max":h,...u,ref:t})})});j.displayName=x;var y="ProgressIndicator",b=n.forwardRef((e,t)=>{var r;let{__scopeProgress:n,...l}=e,s=v(y,n);return(0,a.jsx)(m.sG.div,{"data-state":w(s.value,s.max),"data-value":null!=(r=s.value)?r:void 0,"data-max":s.max,...l,ref:t})});function N(e,t){return"".concat(Math.round(e/t*100),"%")}function w(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function k(e){return"number"==typeof e}function C(e){return k(e)&&!isNaN(e)&&e>0}function _(e,t){return k(e)&&!isNaN(e)&&e<=t&&e>=0}b.displayName=y;var S=r(59434);let O=n.forwardRef((e,t)=>{let{className:r,value:n,...l}=e;return(0,a.jsx)(j,{ref:t,className:(0,S.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...l,children:(0,a.jsx)(b,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});O.displayName=j.displayName;var T=r(30285),L=r(34301);let A=(0,r(40157).A)("Paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]);var P=r(54165),R=r(62523),F=r(85057),M=r(59409),I=r(88539),B=r(85127),E=r(87481),D=r(6874),J=r.n(D),K=r(34953),Z=r(19667),$=r(83013);let G=e=>fetch(e).then(e=>e.json()),H={amount:{label:"Amount (₹)"},Fertilizers:{label:"Fertilizers",color:"hsl(var(--chart-1))"},Seeds:{label:"Seeds",color:"hsl(var(--chart-2))"},Labor:{label:"Labor",color:"hsl(var(--chart-3))"},Machinery:{label:"Machinery",color:"hsl(var(--chart-4))"},Utilities:{label:"Utilities",color:"hsl(var(--chart-5))"},Other:{label:"Other",color:"hsl(var(--chart-1))"},"Livestock Purchase":{label:"Livestock Purchase",color:"hsl(var(--chart-2))"},"Livestock Sale":{label:"Livestock Sale",color:"hsl(var(--chart-3))"},Feeds:{label:"Feeds",color:"hsl(var(--chart-4))"}};function W(){let{toast:e}=(0,E.dj)(),[t,r]=(0,n.useState)(!1),[h,m]=(0,n.useState)({category:"Other",amount:0,description:"",date:new Date().toISOString().split("T")[0],type:"expense"}),{data:x=[],error:p,isLoading:f}=(0,K.Ay)("/api/transactions",G),g=(0,n.useMemo)(()=>x.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),[x]),v=(0,n.useMemo)(()=>x.filter(e=>"revenue"===e.type).reduce((e,t)=>e+t.amount,0),[x]),j=g/1e5*100,y=(0,n.useMemo)(()=>Object.entries(x.filter(e=>"expense"===e.type).reduce((e,t)=>(e[t.category]||(e[t.category]=0),e[t.category]+=t.amount,e),{})).map(e=>{var t;let[r,a]=e;return{category:r,amount:a,fill:(null==(t=H[r])?void 0:t.color)||H.Other.color}}),[x]),b=(e,t)=>{m(r=>({...r,[e]:t}))},N=async()=>{if(!h.category||!h.amount||!h.date)return void e({variant:"destructive",title:"Missing Information",description:"Please fill out category, amount, and date."});let t={category:h.category,amount:Number(h.amount),date:h.date,description:h.description||"",type:h.type};try{await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),(0,Z.j)("/api/transactions"),r(!1),m({category:"Other",amount:0,description:"",date:new Date().toISOString().split("T")[0],type:"expense"}),e({title:"Transaction Added",description:"A new ".concat(t.type," of ₹").concat(t.amount," has been logged.")})}catch(t){console.error("Error adding document: ",t),e({variant:"destructive",title:"Uh oh! Something went wrong.",description:"Could not save the transaction."})}};return p?(0,a.jsx)("div",{children:"Failed to load data"}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Financial Overview"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Track your farm's budget, expenses, and overall financial health."})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(T.$,{asChild:!0,variant:"outline",children:(0,a.jsx)(J(),{href:"/dashboard/finances/view",children:"View Transactions"})}),(0,a.jsxs)(T.$,{onClick:()=>r(!0),children:[(0,a.jsx)(L.A,{className:"mr-2 h-4 w-4"}),"Add Transaction"]})]})]}),(0,a.jsxs)(l.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Budget Overview"}),(0,a.jsx)(l.BT,{children:"Tracking your total spending against the allocated budget for this season."})]}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsx)(O,{value:j,className:"h-4"}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"font-medium",children:["Spent: ₹",g.toLocaleString()]}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Remaining: ₹",(1e5-g).toLocaleString()]}),(0,a.jsxs)("span",{className:"font-medium",children:["Total Budget: ₹",1e5.toLocaleString()]})]})]}),(0,a.jsx)(l.wL,{className:"text-sm",children:(0,a.jsxs)("p",{children:["Total Revenue: ",(0,a.jsxs)("span",{className:"font-semibold text-green-600",children:["₹",v.toLocaleString()]})]})})]}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(l.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Spending Breakdown"}),(0,a.jsx)(l.BT,{children:"A visual breakdown of expenses by category for the current season."})]}),(0,a.jsx)(l.Wu,{children:f?(0,a.jsx)("p",{children:"Loading chart..."}):(0,a.jsx)(s.at,{config:H,className:"min-h-[300px] w-full",children:(0,a.jsxs)(i.E,{accessibilityLayer:!0,data:y,margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(c.d,{vertical:!1}),(0,a.jsx)(o.W,{dataKey:"category",tickLine:!1,tickMargin:10,axisLine:!1}),(0,a.jsx)(d.h,{tickFormatter:e=>"₹".concat(Number(e)/1e3,"k")}),(0,a.jsx)(s.II,{cursor:!1,content:(0,a.jsx)(s.Nt,{indicator:"dot"})}),(0,a.jsx)(u.y,{dataKey:"amount",radius:8})]})})})]}),(0,a.jsxs)(l.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Recent Transactions"}),(0,a.jsx)(l.BT,{children:"A list of the most recent financial entries."})]}),(0,a.jsx)(l.Wu,{children:f?(0,a.jsx)("p",{children:"Loading transactions..."}):(0,a.jsxs)(B.XI,{children:[(0,a.jsx)(B.A0,{children:(0,a.jsxs)(B.Hj,{children:[(0,a.jsx)(B.nd,{children:"Category"}),(0,a.jsx)(B.nd,{children:"Date"}),(0,a.jsx)(B.nd,{className:"text-right",children:"Amount"})]})}),(0,a.jsx)(B.BF,{children:x.slice(0,5).map(e=>(0,a.jsxs)(B.Hj,{children:[(0,a.jsxs)(B.nA,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.category}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground truncate",children:e.description})]}),(0,a.jsx)(B.nA,{children:(0,$.GP)(new Date(e.date),"PPP")}),(0,a.jsxs)(B.nA,{className:"text-right ".concat("revenue"===e.type?"text-green-600":""),children:["revenue"===e.type?"+":"","₹",e.amount.toLocaleString()]})]},e.id))})]})})]})]}),(0,a.jsx)(P.lG,{open:t,onOpenChange:r,children:(0,a.jsxs)(P.Cf,{children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{children:"Add New Transaction"}),(0,a.jsx)(P.rr,{children:"Log a new financial entry for your farm."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"type",className:"text-right",children:"Type"}),(0,a.jsxs)(M.l6,{value:h.type,onValueChange:e=>b("type",e),children:[(0,a.jsx)(M.bq,{className:"col-span-3",children:(0,a.jsx)(M.yv,{placeholder:"Select a type"})}),(0,a.jsxs)(M.gC,{children:[(0,a.jsx)(M.eb,{value:"expense",children:"Expense"}),(0,a.jsx)(M.eb,{value:"revenue",children:"Revenue"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"category",className:"text-right",children:"Category"}),(0,a.jsxs)(M.l6,{value:h.category,onValueChange:e=>b("category",e),children:[(0,a.jsx)(M.bq,{className:"col-span-3",children:(0,a.jsx)(M.yv,{placeholder:"Select a category"})}),(0,a.jsx)(M.gC,{children:Object.values(H).filter(e=>"string"!=typeof e&&e.label).map(e=>(0,a.jsx)(M.eb,{value:e.label,children:e.label},e.label))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"amount",className:"text-right",children:"Amount (₹)"}),(0,a.jsx)(R.p,{id:"amount",type:"number",value:h.amount||"",onChange:e=>b("amount",e.target.valueAsNumber),className:"col-span-3",placeholder:"e.g., 150.00"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"date",className:"text-right",children:"Date"}),(0,a.jsx)(R.p,{id:"date",type:"date",value:h.date||"",onChange:e=>b("date",e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"description",className:"text-right",children:"Description"}),(0,a.jsx)(I.T,{id:"description",value:h.description||"",onChange:e=>b("description",e.target.value),className:"col-span-3",placeholder:"Optional: A brief description of the transaction"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(F.J,{htmlFor:"evidence",className:"text-right",children:"Evidence"}),(0,a.jsxs)("div",{className:"col-span-3",children:[(0,a.jsx)(T.$,{asChild:!0,variant:"outline",className:"w-full justify-start font-normal text-muted-foreground",children:(0,a.jsxs)(F.J,{htmlFor:"evidence-file",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(A,{className:"mr-2 h-4 w-4"}),h.evidence?h.evidence.name:"Attach a file (receipt, invoice...)"]})}),(0,a.jsx)(R.p,{id:"evidence-file",type:"file",className:"hidden",onChange:e=>e.target.files&&b("evidence",e.target.files[0])})]})]})]}),(0,a.jsxs)(P.Es,{children:[(0,a.jsx)(T.$,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),(0,a.jsx)(T.$,{onClick:N,children:"Save Transaction"})]})]})})]})}},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return n}});let a=r(12115);function n(e,t){let r=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=l(e,a)),t&&(n.current=l(t,a))},[e,t])}function l(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81499:(e,t,r)=>{"use strict";r.d(t,{Hm:()=>g,II:()=>x,Nt:()=>p,_3:()=>f,at:()=>h});var a=r(95155),n=r(12115),l=r(83540),s=r(94517),i=r(24026),c=r(59434);let o={light:"",dark:".dark"},d=n.createContext(null);function u(){let e=n.useContext(d);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let h=n.forwardRef((e,t)=>{let{id:r,className:s,children:i,config:o,...u}=e,h=n.useId(),x="chart-".concat(r||h.replace(/:/g,""));return(0,a.jsx)(d.Provider,{value:{config:o},children:(0,a.jsxs)("div",{"data-chart":x,ref:t,className:(0,c.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",s),...u,children:[(0,a.jsx)(m,{id:x,config:o}),(0,a.jsx)(l.u,{children:i})]})})});h.displayName="Chart";let m=e=>{let{id:t,config:r}=e,n=Object.entries(r).filter(e=>{let[,t]=e;return t.theme||t.color});return n.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(o).map(e=>{let[r,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(n.map(e=>{var t;let[a,n]=e,l=(null==(t=n.theme)?void 0:t[r])||n.color;return l?"  --color-".concat(a,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},x=s.m,p=n.forwardRef((e,t)=>{let{active:r,payload:l,className:s,indicator:i="dot",hideLabel:o=!1,hideIndicator:d=!1,label:h,labelFormatter:m,labelClassName:x,formatter:p,color:f,nameKey:g,labelKey:j}=e,{config:y}=u(),b=n.useMemo(()=>{var e;if(o||!(null==l?void 0:l.length))return null;let[t]=l,r="".concat(j||t.dataKey||t.name||"value"),n=v(y,t,r),s=j||"string"!=typeof h?null==n?void 0:n.label:(null==(e=y[h])?void 0:e.label)||h;return m?(0,a.jsx)("div",{className:(0,c.cn)("font-medium",x),children:m(s,l)}):s?(0,a.jsx)("div",{className:(0,c.cn)("font-medium",x),children:s}):null},[h,m,l,o,x,y,j]);if(!r||!(null==l?void 0:l.length))return null;let N=1===l.length&&"dot"!==i;return(0,a.jsxs)("div",{ref:t,className:(0,c.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",s),children:[N?null:b,(0,a.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let r="".concat(g||e.name||e.dataKey||"value"),n=v(y,e,r),l=f||e.payload.fill||e.color;return(0,a.jsx)("div",{className:(0,c.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:p&&(null==e?void 0:e.value)!==void 0&&e.name?p(e.value,e.name,e,t,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==n?void 0:n.icon)?(0,a.jsx)(n.icon,{}):!d&&(0,a.jsx)("div",{className:(0,c.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":N&&"dashed"===i}),style:{"--color-bg":l,"--color-border":l}}),(0,a.jsxs)("div",{className:(0,c.cn)("flex flex-1 justify-between leading-none",N?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[N?b:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==n?void 0:n.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});p.displayName="ChartTooltip";let f=i.s,g=n.forwardRef((e,t)=>{let{className:r,hideIcon:n=!1,payload:l,verticalAlign:s="bottom",nameKey:i}=e,{config:o}=u();return(null==l?void 0:l.length)?(0,a.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center justify-center gap-4","top"===s?"pb-3":"pt-3",r),children:l.map(e=>{let t="".concat(i||e.dataKey||"value"),r=v(o,e,t);return(0,a.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==r?void 0:r.icon)&&!n?(0,a.jsx)(r.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==r?void 0:r.label]},e.value)})}):null});function v(e,t,r){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,n=r;return r in t&&"string"==typeof t[r]?n=t[r]:a&&r in a&&"string"==typeof a[r]&&(n=a[r]),n in e?e[n]:e[r]}g.displayName="ChartLegend"},88539:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var a=r(95155),n=r(12115),l=r(59434);let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});s.displayName="Textarea"},96374:(e,t,r)=>{Promise.resolve().then(r.bind(r,4392))}},e=>{var t=t=>e(e.s=t);e.O(0,[5511,9667,4953,7239,7582,106,3013,2043,6874,6863,3435,956,223,8441,1684,7358],()=>t(96374)),_N_E=e.O()}]);