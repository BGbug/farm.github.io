(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[806],{4813:(e,t,s)=>{Promise.resolve().then(s.bind(s,28343))},6654:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return r}});let a=s(12115);function r(e,t){let s=(0,a.useRef)(null),r=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=s.current;e&&(s.current=null,e());let t=r.current;t&&(r.current=null,t())}else e&&(s.current=n(e,a)),t&&(r.current=n(t,a))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},26126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(95155);s(12115);var r=s(74466),n=s(59434);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},28343:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(95155),r=s(12115),n=s(66695),l=s(85127),i=s(26126),c=s(30285),d=s(34301),o=s(40157);let h=(0,o.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),u=(0,o.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var p=s(54165),g=s(62523),x=s(85057),m=s(59409),j=s(87481),v=s(35339),f=s(35476),y=s(36312),b=s(6874),N=s.n(b),C=s(34953),k=s(19667);let S=e=>fetch(e).then(e=>e.json()),w=["Cow","Buffalo","Goat","Chicken","Sheep"],A=["Male","Female"],F=["Dairy","Meat","Egg Production","Breeding","For Sale","Growing"];function T(){let{toast:e}=(0,j.dj)(),{data:t=[],error:s,isLoading:o}=(0,C.Ay)("/api/livestock",S),[b,T]=(0,r.useState)(!1),[D,M]=(0,r.useState)(!1),[O,P]=(0,r.useState)(!1),[J,E]=(0,r.useState)(null),[B,H]=(0,r.useState)(0),[_,I]=(0,r.useState)({type:"Cow",breed:"",gender:"Female",dob:new Date().toISOString().split("T")[0],purpose:"",cost:0}),L=e=>{if(!e)return"Unknown";let t=new Date(e),s=new Date,a=function(e,t){let s=(0,f.a)(e),a=(0,f.a)(t),r=(0,v.z)(s,a),n=Math.abs(function(e,t){let s=(0,f.a)(e),a=(0,f.a)(t);return s.getFullYear()-a.getFullYear()}(s,a));s.setFullYear(1584),a.setFullYear(1584);let l=(0,v.z)(s,a)===-r,i=r*(n-l);return 0===i?0:i}(s,t);if(a>0)return"".concat(a," year").concat(a>1?"s":"");let r=(0,y.W)(s,t);return"".concat(r," month").concat(r>1?"s":"")},z=(e,t)=>{I(s=>({...s,[e]:t}))},G=async()=>{if(!_.type||!_.breed||!_.gender||!_.dob)return void e({variant:"destructive",title:"Missing Information",description:"Please fill out Type, Breed, Gender, and Date of Birth."});let t={...{type:_.type,breed:_.breed,gender:_.gender,dob:_.dob,status:"Healthy",purpose:_.purpose||"Growing"},id:"".concat(_.type.slice(0,3).toUpperCase(),"-").concat(Date.now().toString().slice(-4))};if(await fetch("/api/livestock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),_.cost&&_.cost>0){let e={category:"Livestock Purchase",amount:Number(_.cost),date:new Date().toISOString(),description:"Purchased ".concat(_.type," (").concat(_.breed,") with ID ").concat(t.id),type:"expense"};await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),(0,k.j)("/api/transactions")}(0,k.j)("/api/livestock"),T(!1),I({type:"Cow",breed:"",gender:"Female",dob:new Date().toISOString().split("T")[0],purpose:"",cost:0}),e({title:"Animal Added",description:"A new ".concat(_.type," has been added.")})},$=e=>{E({...e}),M(!0)},V=e=>{E(e),H(0),P(!0)},Y=async()=>{if(J&&B>0){let t={category:"Livestock Sale",amount:Number(B),date:new Date().toISOString(),description:"Sold ".concat(J.type," (").concat(J.breed,") with ID ").concat(J.id),type:"revenue"};await fetch("/api/livestock/".concat(J.id),{method:"DELETE"}),await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),(0,k.j)("/api/livestock"),(0,k.j)("/api/transactions"),P(!1),E(null),e({title:"Animal Sold!",description:"".concat(J.type," ID ").concat(J.id," has been sold for â‚¹").concat(B,".")})}else e({variant:"destructive",title:"Invalid Price",description:"Please enter a valid selling price."})},q=(e,t)=>{J&&E(s=>s?{...s,[e]:t}:null)},U=async()=>{J&&(await fetch("/api/livestock/".concat(J.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),(0,k.j)("/api/livestock"),M(!1),E(null),e({title:"Animal Updated",description:"The animal's information has been successfully updated."}))};return s?(0,a.jsx)("div",{children:"Failed to load livestock"}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Livestock Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Track and manage all the animals on your farm."})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.$,{asChild:!0,children:(0,a.jsx)(N(),{href:"/dashboard/livestock/analyze",children:"Live Health Analysis"})}),(0,a.jsxs)(c.$,{onClick:()=>T(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Add Animal"]})]})]}),(0,a.jsxs)(n.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Livestock Herd"}),(0,a.jsx)(n.BT,{children:"A complete list of all animals currently on the farm."})]}),(0,a.jsx)(n.Wu,{children:o?(0,a.jsx)("p",{children:"Loading livestock..."}):(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{children:(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nd,{children:"ID"}),(0,a.jsx)(l.nd,{children:"Type"}),(0,a.jsx)(l.nd,{children:"Breed"}),(0,a.jsx)(l.nd,{children:"Gender"}),(0,a.jsx)(l.nd,{children:"Purpose"}),(0,a.jsx)(l.nd,{children:"Age"}),(0,a.jsx)(l.nd,{children:"Status"}),(0,a.jsx)(l.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(l.BF,{children:t.map(e=>(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"font-mono text-sm",children:e.id}),(0,a.jsx)(l.nA,{className:"font-medium",children:e.type}),(0,a.jsx)(l.nA,{className:"text-muted-foreground",children:e.breed}),(0,a.jsx)(l.nA,{children:e.gender}),(0,a.jsx)(l.nA,{children:e.purpose&&(0,a.jsx)(i.E,{variant:"outline",children:e.purpose})}),(0,a.jsx)(l.nA,{children:L(e.dob)}),(0,a.jsx)(l.nA,{children:(0,a.jsx)(i.E,{variant:"Healthy"===e.status?"default":"destructive",className:"Healthy"===e.status?"bg-green-500/80 text-primary-foreground":"bg-yellow-500/80",children:e.status})}),(0,a.jsxs)(l.nA,{className:"text-right",children:[(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>$(e),children:(0,a.jsx)(h,{className:"h-4 w-4"})}),(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>V(e),children:(0,a.jsx)(u,{className:"h-4 w-4"})})]})]},e.id))})]})})]}),(0,a.jsx)(p.lG,{open:b,onOpenChange:T,children:(0,a.jsxs)(p.Cf,{children:[(0,a.jsxs)(p.c7,{children:[(0,a.jsx)(p.L3,{children:"Add New Animal"}),(0,a.jsx)(p.rr,{children:"Log a new animal in your farm's inventory. You can add the purchase cost to create a financial record."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"animal-type",className:"text-right",children:"Type"}),(0,a.jsxs)(m.l6,{value:_.type,onValueChange:e=>z("type",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{placeholder:"Select animal type"})}),(0,a.jsx)(m.gC,{children:w.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"breed",className:"text-right",children:"Breed"}),(0,a.jsx)(g.p,{id:"breed",value:_.breed,onChange:e=>z("breed",e.target.value),className:"col-span-3",placeholder:"e.g., Holstein, Boer"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"purpose",className:"text-right",children:"Purpose"}),(0,a.jsxs)(m.l6,{value:_.purpose,onValueChange:e=>z("purpose",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{placeholder:"Select purpose (optional)"})}),(0,a.jsx)(m.gC,{children:F.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"gender",className:"text-right",children:"Gender"}),(0,a.jsxs)(m.l6,{value:_.gender,onValueChange:e=>z("gender",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{placeholder:"Select gender"})}),(0,a.jsx)(m.gC,{children:A.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"dob",className:"text-right",children:"Date of Birth"}),(0,a.jsx)(g.p,{id:"dob",type:"date",value:_.dob,onChange:e=>z("dob",e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"cost",className:"text-right",children:"Cost (â‚¹)"}),(0,a.jsx)(g.p,{id:"cost",type:"number",value:_.cost||"",onChange:e=>z("cost",e.target.valueAsNumber),className:"col-span-3",placeholder:"Enter purchase price if applicable"})]})]}),(0,a.jsxs)(p.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:G,children:"Add Animal"})]})]})}),J&&(0,a.jsx)(p.lG,{open:D,onOpenChange:M,children:(0,a.jsxs)(p.Cf,{children:[(0,a.jsxs)(p.c7,{children:[(0,a.jsx)(p.L3,{children:"Edit Animal"}),(0,a.jsxs)(p.rr,{children:["Update the details for ",J.id,"."]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-animal-type",className:"text-right",children:"Type"}),(0,a.jsxs)(m.l6,{value:J.type,onValueChange:e=>q("type",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{})}),(0,a.jsx)(m.gC,{children:w.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-breed",className:"text-right",children:"Breed"}),(0,a.jsx)(g.p,{id:"edit-breed",value:J.breed,onChange:e=>q("breed",e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-purpose",className:"text-right",children:"Purpose"}),(0,a.jsxs)(m.l6,{value:J.purpose,onValueChange:e=>q("purpose",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{})}),(0,a.jsx)(m.gC,{children:F.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-gender",className:"text-right",children:"Gender"}),(0,a.jsxs)(m.l6,{value:J.gender,onValueChange:e=>q("gender",e),children:[(0,a.jsx)(m.bq,{className:"col-span-3",children:(0,a.jsx)(m.yv,{})}),(0,a.jsx)(m.gC,{children:A.map(e=>(0,a.jsx)(m.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-dob",className:"text-right",children:"Date of Birth"}),(0,a.jsx)(g.p,{id:"edit-dob",type:"date",value:J.dob,onChange:e=>q("dob",e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"edit-status",className:"text-right",children:"Status"}),(0,a.jsx)(g.p,{id:"edit-status",value:J.status,onChange:e=>q("status",e.target.value),className:"col-span-3"})]})]}),(0,a.jsxs)(p.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:U,children:"Save Changes"})]})]})}),J&&(0,a.jsx)(p.lG,{open:O,onOpenChange:P,children:(0,a.jsxs)(p.Cf,{children:[(0,a.jsxs)(p.c7,{children:[(0,a.jsxs)(p.L3,{children:["Sell Animal: ",J.id]}),(0,a.jsxs)(p.rr,{children:["Enter the selling price for this ",J.type,". This will remove the animal from the active list and record the revenue."]})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"sell-price",className:"text-right",children:"Sell Price (â‚¹)"}),(0,a.jsx)(g.p,{id:"sell-price",type:"number",value:B||"",onChange:e=>H(e.target.valueAsNumber),className:"col-span-3",placeholder:"e.g., 500"})]})}),(0,a.jsxs)(p.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,a.jsx)(c.$,{onClick:Y,variant:"destructive",children:"Confirm Sale"})]})]})})]})}},35339:(e,t,s)=>{"use strict";s.d(t,{z:()=>r});var a=s(35476);function r(e,t){let s=(0,a.a)(e),r=(0,a.a)(t),n=s.getTime()-r.getTime();return n<0?-1:n>0?1:n}},35476:(e,t,s)=>{"use strict";function a(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}s.d(t,{a:()=>a})},36312:(e,t,s)=>{"use strict";s.d(t,{W:()=>i});var a=s(35339),r=s(77424),n=s(35476),l=s(74641);function i(e,t){let s,i=(0,n.a)(e),c=(0,n.a)(t),d=(0,a.z)(i,c),o=Math.abs((0,r.U)(i,c));if(o<1)s=0;else{1===i.getMonth()&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-d*o);let t=(0,a.z)(i,c)===-d;(function(e){let t=(0,n.a)(e);return+function(e){let t=(0,n.a)(e);return t.setHours(23,59,59,999),t}(t)==+(0,l.p)(t)})((0,n.a)(e))&&1===o&&1===(0,a.z)(e,c)&&(t=!1),s=d*(o-Number(t))}return 0===s?0:s}},74641:(e,t,s)=>{"use strict";s.d(t,{p:()=>r});var a=s(35476);function r(e){let t=(0,a.a)(e),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}},77424:(e,t,s)=>{"use strict";s.d(t,{U:()=>r});var a=s(35476);function r(e,t){let s=(0,a.a)(e),r=(0,a.a)(t);return 12*(s.getFullYear()-r.getFullYear())+(s.getMonth()-r.getMonth())}}},e=>{var t=t=>e(e.s=t);e.O(0,[5511,9667,4953,7239,7582,2043,6874,6863,223,8441,1684,7358],()=>t(4813)),_N_E=e.O()}]);